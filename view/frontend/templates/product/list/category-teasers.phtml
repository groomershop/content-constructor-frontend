<?php
    /**
     * Product grid teasers template (POP)
     * @var $block \Magento\Catalog\Block\Product\ListProduct
     * @var $paginationViewModel \MageSuite\ContentConstructorFrontend\ViewModel\PaginationViewModel
     */
?>
<?php
$paginationViewModel = $block->getPaginationViewModel();
$teasersConfig = $this->helper('MageSuite\ContentConstructorFrontend\Helper\CategoryGridTeasers')->getConfig();
$showOnlyOnFirstPage = isset($teasersConfig['showOnlyOnFirstPage']) ? $teasersConfig['showOnlyOnFirstPage'] : false;

if ($teasersConfig && ($paginationViewModel->isFirstPage() || !$showOnlyOnFirstPage)) : ?>
    <?php $i = 1 ?>

    <?php foreach ($teasersConfig['teasers'] as $teaser): ?>
        <?php 
        $newTeaserConfig = array(
            "scenario" => array(
                'desktopLayout' => array(
                    'id' => 1,
                ),
                'mobileLayout' => array(
                    'id' => 'mobile-large',
                ),
                'contentPlacement' => array(
                    'id' => 'over',
                ),
                'teaserWidth' => array(
                    'id' => 'window',
                )
            ),
            "items" => array(
                0 => $teaser,
            ),
        );
        ?>

        <?php /*  $this->getLayout()
            ->createBlock('MageSuite\ContentConstructorFrontend\Block\Component\ImageTeaser')
            ->setTemplate('MageSuite_ContentConstructorFrontend::component/image_teaser/image_teaser_slide.phtml')
            ->setSlide($teaser)
            ->setImageTeaser($newTeaserConfig)
            ->setIsSlider(false)
            ->setIsSliderMobile(false)
            ->setContentPlacement($newTeaserConfig['scenario']['contentPlacement']['id'])
            ->toHtml();
        */ ?>

        <?= $this->getLayout()
            ->createBlock('MageSuite\ContentConstructorFrontend\Block\Component\ImageTeaser')
            ->setData($newTeaserConfig)
            ->setGridTeaser(true)
            ->setTeaserId($i)
            ->setTeaserData($teaser)
            ->setBrickClass($block->getBrickClass())
            ->setMix('cs-image-teaser--grid-teaser ' . $block->getMix())
            ->setContainerMix('cs-container--grid-teaser ' . $block->getContainerMix())
            ->toHtml();
        ?>

        <?php $i++ ?>
    <?php endforeach; ?>
<?php endif; ?>
